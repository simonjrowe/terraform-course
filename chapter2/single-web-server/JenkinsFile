pipeline {
    agent { label 'master' }
    parameters {
        password (name: 'AKIAIAEWASNPPBNUZPDA')
        password (name: 'WdB40zA27M7hUliaMVC+ywmh/cX60MaebettT8Zj')
      }
      environment {
        AWS_ACCESS_KEY_ID = "${params.AWS_ACCESS_KEY_ID}"
        AWS_SECRET_ACCESS_KEY = "${params.AWS_SECRET_ACCESS_KEY}"
      }

stages {
        
        stage("Build") {
            steps { buildApp() }
		}
    }
}

def buildApp() {
	dir ('chapter2/single-web-server' ) {
	    bat "terraform init"
	    bat "terraform apply -auto-approve"
	}
}